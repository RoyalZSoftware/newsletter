#!/bin/bash

BASE_DIR=./test # can be overriden

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
LIB_DIR="$SCRIPT_DIR/../lib"

# Bei Installation z.â€¯B. in /usr/local/bin, LIB_DIR auf /usr/local/share/newsletter setzen
if [ "$SCRIPT_DIR" = "/usr/local/bin" ]; then
    LIB_DIR="/usr/local/share/newsletter"
fi

source $LIB_DIR/abstract.mailservice.sh

CONTENT_DIR=$LIB_DIR/content
TEMPLATE=$CONTENT_DIR/template.html
MAIL_SERVICE=unset

if [ -f ~/.newsletter ]; then
    . ~/.newsletter
else
    cp .newsletter.example ~/.newsletter # override any settings in here.
fi

if [ "$MAIL_SERVICE" = "sendgrid" ]; then
    . $LIB_DIR/sendgrid.mailservice.sh
fi

source $LIB_DIR/newsletter.sh

if [ "$1" = "" ];
then
usage
exit 1
fi

# use params from cli to invoke functions from lib/newsletter.sh
"$@"
